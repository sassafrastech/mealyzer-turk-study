<h3>Mealyzer Turk Study: Admin Panel</h3>

<ul>
  <li><%= link_to("Next available condition", new_user_path(@fake_turk_params)) %></li>
  <% User::CONDITION_NAMES.each_with_index do |name, i| %>
    <% cond = i + 1 %>
    <li>
      <% if User::ACTIVE_CONDITIONS.include?(cond) %>
        <%= link_to("Condition ##{cond}: #{name}", new_user_path(@fake_turk_params.merge(force_condition: cond))) %>
      <% else %>
        <%= "Condition ##{cond}: #{name}" %>
      <% end %>
    </li>
  <% end %>
  <li><%= link_to("Exit Tryout Mode", "/admin", method: :delete) %></li>
</ul>

<h4>User Stats</h4>
<table class="stats">
  <tr class="top">
    <th></th>
    <th colspan="<%= User::ACTIVE_CONDITIONS.size + 1%>">Complete</th>
    <th colspan="<%= User::ACTIVE_CONDITIONS.size + 1%>">Incomplete</th>
  </tr>
  <tr>
    <th>Study</th>
    <% %w(Complete Incomplete).each do |comp| %>
      <th>Seed</th>
      <% User::ACTIVE_CONDITIONS.each do |c| %>
        <th>#<%= c %></th>
      <% end %>
    <% end %>
  </tr>
  <% @studies.each do |s| %>
    <tr>
      <td><%= s %></td>
      <% [true, false].each do |comp| %>
        <td><%= @stats[[s, "seed", 1, comp]] %></td>
        <% User::ACTIVE_CONDITIONS.each do |c| %>
          <td><%= @stats[[s, "main", c, comp]] %></td>
        <% end %>
      <% end %>
    </tr>
  <% end %>
</table>

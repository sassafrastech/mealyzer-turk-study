<div class="matches">
  <div class="row">
    <div class="col-md-10">
      <h3>Instructions</h3>
      <p>In each photo below, a box containing  one food item will be highlighted. Next to it, you will see a description of this item and its ingredients identified by you or other Turkers. Your job is to match each of these ingredients to the four food groups. These food groups include carbohydrates, fats, protein, and fiber. You need to map each ingredient to one food group.</p>
    </div>
  </div>
  <div class="row">
  <%= render partial: "shared/flash_messages", flash: flash %>
    <div class="col-md-5">
      <%= image_tag @match_answer.meal.photo, :id => "photo" %>
      <% #DRAW Rectangle %>
    </div>
    <div class="col-md-6">
      <h3>(<%= @match_answer.num_tests + 1 %>/<%= MatchAnswer::MAX_TESTS %>) <%= @match_answer.meal.food_options %></h3>

      <%= simple_form_for @match_answer do |f| %>
        <h3><%= @match_answer.component_name %></h3>
        <%= f.hidden_field :meal_id %>
        <%= f.hidden_field :component_name %>
        <%= f.hidden_field :user_id %>

        <table>
          <tr><td>What is it made of?</td><td colspan="3">What food group does it belong to?</td></tr>
          <tr class="groups">
            <td></td>
            <% Meal::GROUPS.each do |h| %>
              <td><%= h %></td>
            <% end %>
          </tr>
          <% @match_answer.items.each do |item| %>
            <tr>
              <td><label><%= item %></label></td>
              <% Meal::GROUPS.each do |group| %>
                <td class="cb">
                 <%= check_box_tag "match_answer[food_groups][#{item}][]", group, @match_answer.item_has_group?(item, group), :disabled => @disabled %>
              <% end %>
            </tr>
          <% end %>
        </table>
        <br/>
        <%= f.submit :submit, :class => "btn btn-primary", :disabled => @disabled %>
      <% end %>
    </div>
  </div>
</div>

<%= javascript_doc_ready do %>
  new Mealyzer.Views.MatchesView({el: '.matches', geometry: <%= @match_answer.location.to_json.html_safe %>, name: "<%= @match_answer.component_name %>", source: "<%= "#{request.protocol}#{request.host_with_port}#{@match_answer.meal.photo.url}" %>"});
<% end %>

